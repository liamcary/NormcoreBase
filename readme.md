model i# Normcore Base

This is an experiment for creating a base class and workflow for easily producing offline and realtime prefabs in the Normcore multiplayer solution for Unity3D. 

## Description

When connected to a Normcore room you need to use Realtime.Instantiate to instantiate prefabs that contain RealtimeComponents/RealtimeTransform/etc. But if you're not connected to a room, you need to use something like GameObject.Instantiate to instantiate an offline version of these prefabs without any Realtime components.

When mananging a lot of different objects that need multiplayer support an optimal workflow could save tons of time, so I set out to create a re-usable base that will simplify the creation and initialisation of realtime and offline models and prefabs. 

## About

The meat of the project are the BaseComponent and BaseComponentRealtime classes in Assets/Scripts/Base. These are generic abstract classes that assume the data that you want to synchronize is made up of a base interface model, an offline model, and a realtime model generated by Normcore's code generation. 

- **BaseComponent** is a MonoBehaviour component that exposes a reference to the base model interface. The child classes of this can set data and respond to changes in the data, or other components can reference this component for acces to the model interface. This doesn't expose the offline or realtime models, because consumers of the data should not care where the data comes from. In Awake, BaseComponent will look for a BaseComponentRealtime component. If a realtime component is found, the base model interface reference points to the realtime instance, otherwise it'll point to the offline instance. If a realtime component is found but normcore is not connected to a room, the realtime component will be destroyed.
- **BaseComponentRealtime** is a child of the Normcore RealtimeComponent class. It wraps some common functionality and exposes methods for initialization and registering/unregistering events to reduce the amount boilerplate code required in each realtime component.

There are two very basic examples of models in the Int and String folders. Using the String example:
- **IStringModel** is the base interface, defining the properties and events that consumers of the String model can access.
- **StringModel** is the offline version of the model and is just a simple class that inherits IStringModel. The class can be serialized if you want to be able to set default values in the inspector, but doesnt have to be serializable.
- **StringModelRealtime** is the realtime version of the model. Importantly, this does *not* inherit the IStringModel interface. This is because normcore has requirements on the naming convention of your private variables in order for it to generate the model code for you. 
- **StringComponent** is the MonoBehaviour component that holds the model, whether offline or realtime. It exposes an IStringModel reference which could be either an instance of StringModel or StringComponentRealtime. This is required on both offline and realtime prefabs.
- **StringComponentRealtime** is an additional component that exists only on the realtime version of a prefab. It inherits from BaseComponentRealtime *and* IStringModel, so that StringComponent's IStringModel reference can point to either this or an offline model.

## Result

This pattern standardises the method of creating synchronised gameobjects and makes it very easy to create the offline and realtime prefabs. To create the realtime version, you can just create a prefab variant of the offline model and add it's StringComponentRealtime script. 

However, it's pretty tedious setting up the 5 classes required to represent one data model. For simple models (e.g, StringModel) I'd love to be able to include IStringModel, StringModel and StringModelRealtime in one file, but for Normcore's code generation to work on StringModelRealtime it needs to be in its own file with a matching file name. 

I've also implemented, but not thoroughly tested, a system to check if a prefab contains a realtime component when Normcore is not connected. In this case, the realtime component and the Normcore RealtimeView will be destroyed. If this pattern works well, then we could just have one version of a realtime prefab which converts itself into an offline version after it is instantiated.